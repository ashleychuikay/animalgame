---
title: "Animal Game Transcripts"
author: "Ashley Leung, Alex Tunkel, and Dan Yurovsky"
date: '`r Sys.Date()`'
output: 
  html_document:
    toc: false
    number_sections: false
    theme: lumen
    toc_float: false
    code_folding: hide
---
```{r, message=FALSE, warning=FALSE, show = F}
library(tidyverse)
library(forcats)
library(knitr)
theme_set(theme_classic(base_size = 14))
```

Read in data

```{r read_data, message=F}
data <- read_csv("../raw_data/9261.csv")
```

Munge data 

```{r munge}
# Pull out either parent or child's data
pull_data <- function(person) {
  data %>%
    select(starts_with(person)) %>%
    select_all(~gsub(person, "", .x)) %>%
    select_all(~gsub("Utterance\\.", "", .x)) %>%
    mutate(person = person)

}

# Tidy up
tidy_data <- bind_rows(pull_data("Child"), pull_data("Parent")) %>%
  mutate(target = gsub("\\.", "", target) %>% tolower) %>%
  mutate(utterance = str_trim(utterance))

targets <- tidy_data %>%
  distinct(target) %>%
  filter(!is.na(target), target != "n/a") %>%
  pull()

practice_targets <- c("artichoke", "apple") 
```

The unique targets were: `r targets`

```{r make_target_df}
target_data <- tidy_data %>%
  filter(target %in% targets) %>%
  mutate(length = str_count(utterance, " ") + 1) %>%
  group_by(target) %>%
  mutate(n = 1:n()) 
```

```{r show_lobster}
target_data %>%
  filter(target == "lobster") %>%
  kable()
```